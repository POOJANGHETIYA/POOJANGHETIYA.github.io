<!DOCTYPE html>
<html lang="en">

<head>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>URL Shortener</title>
     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<body>
     <div class="container mt-5">
          <div class="row justify-content-center">
               <div class="col-md-8">
                    <div class="card">
                         <div class="card-header bg-primary text-white">
                              <h3 class="mb-0">URL Shortener</h3>
                         </div>
                         <div class="card-body">
                              <form id="urlShortenerForm">
                                   <div class="form-group">
                                        <label for="originalUrl">Enter your long URL:</label>
                                        <input type="text" class="form-control" id="originalUrl" name="originalUrl"
                                             placeholder="https://www.example.com">
                                   </div>
                                   <button type="submit" class="btn btn-primary">Shorten URL</button>
                              </form>
                              <div class="mt-3" id="shortenedUrlDiv" style="display: none;">
                                   <label for="shortenedUrl">Shortened URL:</label>
                                   <div class="input-group">
                                        <input type="text" class="form-control" id="shortenedUrl" name="shortenedUrl"
                                             readonly>
                                        <button type="button" class="btn btn-primary" id="copyUrlBtn">Copy
                                             URL</button>
                                   </div>
                              </div>
                         </div>
                    </div>
               </div>
          </div>
     </div>

     <!-- jQuery and Bootstrap JS -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

     <script>
          // Function to handle form submission
          const form = document.getElementById('urlShortenerForm');
          form.addEventListener('submit', function (event) {
               event.preventDefault();
               const baseURL = window.location.origin;
               const formData = new FormData(this);
               const url = formData.get('originalUrl');
               const data = {
                    originalUrl: url
               };
               // Send POST request to the server
               fetch('/shorten', {
                    method: 'POST',
                    headers: {
                         'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
               })
                    .then(response => response.json())
                    .then(data => {
                         // Display shortened URL
                         document.getElementById('shortenedUrl').value = baseURL + '/' + data.shortUrl;
                         document.getElementById('shortenedUrlDiv').style.display = 'block';
                    })
                    .catch((error) => {
                         console.error('Error:', error);
                    });
          });
     </script>

     <script>
          const copyUrlBtn = document.getElementById('copyUrlBtn');
          copyUrlBtn.addEventListener('click', function (event) {
               const shortenedUrl = document.getElementById('shortenedUrl');
               shortenedUrl.select();
               document.execCommand('copy');
               alert('Copied the text: ' + shortenedUrl.value);
          });
     </script>
</body>

</html>